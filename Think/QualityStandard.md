# 关于质量标准化的思考和实践

在项目交付时，产品已经完成了，到了用户手中，很难做出修复、改进。这意味着，一旦项目交付质量不佳，对于客户往往是不可接受的。
而提高产品质量，是一套整的标准流程，通过一套质量标准化，推送质量内建，提高研发部门的交付质量。

# 一、定义

## 1.1 质量标准化

质量标准化，通过一套标准化的流程来推送产品研发，**保证高质量的交付**。标准化之后，某一种程度上来说，类似流水线生产。
比起小作坊的产品，大家更愿意使用流水线的产品，很大原因是流水线是一套标准、固定的，它的质量也是稳定的。

## 1.2 质量内建

大多数研发团队的同学都认为质量是需要测试同学来保证的，认为测试是产品的兜底的最后一环，出了问题就是测试的问题。
但是要想给用户交付高质量的产品和体验，必须要在研发流程各个环节都遵守质量规范，在需求评审、方案设计、开发、自测、测试环节上的产品、开发、测试同学都要有质量意识并严格执行质量规范，这就是质量内建。

##  1.3 交付质量

交付质量包含系统质量和产品体验两部分。系统质量指的是系统的功能完备性、系统的稳定性和健壮性，产品体验是指客户使用此产品时是否有丝滑的体验。

# 二、共识

要让研发流程中的各个角色都愿意去践行一套统一的标准和规范，必不可少的条件是各个角色意识形态上的统一。只有团队的思想一致了，标准和规范才能被推进并落实。

## 2.1 质量不只是测出来的

在知乎上看到针对“质量是被设计出来的，还是被测出来的”问题有一个讨论，觉得写的挺好的，从不同角度分析了这个命题，我把它摘抄出来，针对“质量之道”的本源之争，大家的发言很踊跃，我摘抄了几个具有代表性的：

> A同学：我认为质量是设计出来的，在设计上考虑的各种非功能质量数据，都会落地到代码中。设计的优化会不断的驱动系统质量的优化。
>
> B同学：我认为质量是测试出来的，设计的东西可以避免已知的问题，但在实际测试的过程中，还是会发现其他未考虑到的问题，例如兼容性问题，你能提前通过设计预防吗？所以测试发现问题，问题驱动质量提升。
>
> C同学：听完B同学的发言，我更坚信了质量是设计出来的。在不断的BUG驱动下，我们打补丁式做出来的系统，质量会更好吗？打补丁解一时之急，而后续系统性的设计、重构、升级，才是提升质量的关键点。所以...
>
> D同学：如果站到产品层面，我们会怎样去定义产品好不好？在我们定义产品好坏的质量模型里，很可能会包含软件研发相关的非功能质量属性(ISO9126)，可能会包括产品舆情、竞品对比中挖掘出的东西。例如，我们去定义一款内容推荐产品的好坏，除了“内容不重复”、“多样性”等维度外，“是否支持分享”、“是否支持点赞”也会成为质量好坏的评判标准，新功能上线、满足需求，用户就会认为产品好。我们的认知会不断升级，“好”的标准也会有更高的要求。用户无时无刻不在使用、测试、反馈，让质量不断变好。

## 2.2 既要、又要、还要、且要

上述的四位同学的观点，代表了不同的质量理念和追求：

> 1. **谋而后动的观点**：无论是对需求的二义性分析、对设计中UML图的流程分析、时序分析、状态分析，都是希望能够磨刀不误砍柴工、降低成本。A同学说得对。
> 2. **探索式测试的观点**：无论是保证在设计变成代码的过程中是否100%的完成翻译，还是在测试的过程中受到启发认为应该写下更多的逻辑代码，都是希望所见即所得，想人之未想。B同学说得也对。
> 3. **技术宅的观点**：无论是对前段时间的补丁代码进行重构，还是对系统进行架构的升级，还是对基建能力进行优化，都是希望能够打好底盘，走的更远，走得更稳。C同学靠谱。
> 4. **持续改进的观点**：无论是做竞品分析、舆情分析、线上主动检测、监控、产品质量模型等事情，都希望能够在已有认知和未有认知里发现问题、发现不足。D同学思维广。

既然大家都说得对，都代表了一种优秀的质量理念，那么就不需要取舍了，既要、又要、还要、且要。

所以我们最后的结论就成了：

“质量既是设计出来的，也是测试出来的，还是被逼出来的”，但质量一定不只是测出来的，质量保障不只是测试一种角色的责任，是贯穿研发流程各个角色共同的责任。

## 2.3 缺陷发现的时间越早，成本越低

毫无疑问，缺陷被越早的发现，修复的成本就越低。在需求评审阶段就发现需求上的不合理，在技术设计阶段就发现技术方案的问题所在，在测试验证阶段发现系统的bug和产品bug，修复这些环节发现的问题的成本逐渐升高，但如果问题对客后才被发现，修复的成本将是巨大的，可能会影响客户体验和满意度，或造成资损，甚至导致公司名誉受损。 

## 2.4 测试策略本质上是在质量成本和质量风险之间取得平衡的一种方法

我们知道，程序的执行场景和场景中涉及的数据输入都是无法穷举的（我们也不知道用户实际会操作什么），因此测试是不能被穷举的。所以我们需要进行测试方案的设计，通过运用黑盒测试用例设计的等价类、边界值法等，白盒测试用例设计的条件覆盖法、路径覆盖法等从无限的测试数据中选出有效的测试数据，**在有限的测试时间内进行有效的测试。**

## 2.5 开发自测是基本要求和基本素养

我们一直在强调开发自测，无论需求是否有测试接手，开发都必须要自觉地完成自测。作为一名合格的开发，**本身就要对自己交付的代码有充分的质量保证，这应该是自上而下地在团队里需要贯彻的思想和共识。**

# 三、实践

测试接受类需求研发流程：

> 【项目启动】
>
> 1. 需求阶段
> 2. 资源投入评估
> 3. 技术方案评审
> 4. 测试用例评审
> 5. 开发&自测&联调
> 6. 功能预演
> 7. 测试阶段
> 8. 发布计划评审
> 9. 发布&发布后
>
> 【项目复盘】



## 3.1 需求阶段

在需求阶段我们常遇到的问题是，在项目开发过程中，才发现存在未评估到的需求点，如果要实现这些未评估到的需求点，可能会导致项目延期，也无疑会加重项目组成员的压力。



## 3.2 资源投入评估

需求评审结束后，开发和测试同学需要评估投入的开发资源和测试资源，需求PM会拉通各方定下排期，主要包括联调时间、提测时间和发布上线时间，各个节点的时间一旦确定，PM和 TPM（技术项目管理）将会严格按照这个时间点来推进，一般是不允许延期交付的，除非有特殊原因，比如其它紧急需求临时插入等。除了定下排期，测试还会评估该需求是开发自测还是测试介入。
总的来说这一环节，最重要的规范是：

> 1. 拉通各方资源，协调排期 （PM）
>
> 2. 确定联调时间、提测时间、发布上线时间，接下来PM和TPM 会严格按照这三个节点推进项目（PM 和 TPM）
> 3. 由测试确认是否需要测试接手（QA）

衡量这一环节好的好好的指标是：

> 1. 提测准点率
> 2. 提测通过率
> 3. 发布准点率

## 3.3 技术方案评审

在进入开发前，必不可少的环节便是技术方案的设计和评审。此环节做得好的话，可以让后面的环节走得事半功倍。
总的来说，技术方案设计会要求开发考虑到以下方面：

> 1. 目标和背景
> 2. 功能点及开发人日
> 3. 系统间和系统内的交互时序图
> 4. 数据库设计
> 5. 接口设计（包括提供给前端的接口和提供给业务上下游的接口）
> 6. 定时任务设计
> 7. 接口性能评估
> 8. 兼容性评估（是否兼容旧功能）
> 9. 灰度方案
> 10. 系统监控
> 11. 核对方案



## 3.4 测试用例评审

详细的测试方案和测试用例评审**一来可以让测试同学对本次需求的改动和风险了然于胸，二来可以帮助开发梳理功能点和影响范围，三来可以正式拉通三方（测试、开发、产品）对本次交付功能点的共识**。

总的来说，测试方案设计会要求测试考虑到以下方面：

> 1. 需要提供给开发的冒烟用例
> 2. 本次需求的功能点及对应的覆盖用例
> 3. 本次需求改动点可能影响的旧功能及回归用例
> 4. 上下游联测方案和时间点
> 5. 可能导致的资损点分析及需要建核对的场景
> 6. 接口性能分析
> 7. 灰度发布方案分析
> 8. 维护并且更新主干用例库

### 3.5 开发&自测&联调

在自测环节，测试会提前提供一份冒烟用例给到开发自测。同时，也要求开发必须把冒烟用例的所有场景走完才可以提测。

衡量这一环节做的好不好的指标是：

> 1. 提测准点率
>
> 2. 提测通过率
>
> 3. 自测可发现 bug 率

## 3.6 功能预演阶段

在没有提出功能预演这个环节之前，常常会出现开发们提测的功能连页面都打不开或者接口调不通的低质量问题，低质量的提测会导致测试非常被动。为了避免这种问题，提出了功能预演，即在提测前PM需要拉测试和开发一起对提测的版本进行一轮功能预演，保证主流程是可以走通的，这样子可以快速地在提测前就把非常低级的问题快速解决，也让测试同学能有更多的时间测试系统异常流，保证项目的交付质量。



## 3.7 测试阶段

测试同学需要每天及时同步测试进展和风险，同时要求 bug 开发日结。测试同学每日日报模板：

> 一、项目里程碑
>
> 二、进展和问题
>
> 三、风险
>
> 四、明日计划

## 3.8 发布计划评审

相信不少同学会遇到过这样一种情况，很多场景在预发验收的时候没有问题，一发到线上发现这些场景就走不通了，经过一番排查发现原因是：接口没有多注册、mq的 topic 没有配置、dts 定时任务没有启用等配置类问题。为了避免这类问题再度发生，我们要求：

**在大项目发布前，需要进行发布计划评审，在发布前在项目组内同步一遍准备工作，之后再进行发布。**

发布计划模板如下：

> 1. 发布范围
>
>    1. 应用范围
>    2. 发布顺序
>
> 2. 资源梳理
>
> 3. 1. HSF接口
>    2. 数据库资源
>    3. 消息资源（mq）
>    4. 调度资源（dts）
>    5. 配置资源（diamond、switch、antx）
>
> 4. 灰度计划
>
> 5. 发布过程
>
> 6. 1. 预发发布过程
>    2. 线上发布过程
>
> 7. 回滚计划
>
> 8. 跟踪计划
>
> 9. 1. 核对
>    2. 系统监控
>    3. 服务监控
>
> 10. 风险控制和注意事项
>
> 11. 1. 历史数据兼容
>     2. 幂等逻辑确认
>     3. 灰度方案
>     4. 应急开关

衡量这一环节做的好不好的指标是：

> 线上bug率

## 3.9 发布&发布后

发布过程中，遵循一下原则：

1. beta 至少一个小时，可回滚
2. 业务上可灰度，灰度没问题后再放开到全量用户

对于功能发布后的系统跟踪，主要通过系统监控、服务监控、核对来覆盖，当出现异常时，开发和测试会第一时间去关注原因并解决问题。

对于功能发布后的用户体验跟踪，目前主要是通过灰度客户的反馈以及全量后工单的分析。

# 总结

质量标准化是一个只是一个标准，定下来之后，还是依靠测试和开发同学在后续的项目中运营、落实、完善并继续优化。

在一个有足够人力的团队中，质量标准化实施就简单了。如果项目初期资源还没更上，部分阶段可简略但是不可跳过，因为每一步都是为了产品质量。

### 参考

* [关于质量标准化的思考和实践](https://mp.weixin.qq.com/s/WM9ZOe2Rf1Jn0nmT4MI5Gw)
* [产品质量是生产设计出来的，并不是检验出来的！](https://zhuanlan.zhihu.com/p/455740729)
* [质量是设计出来的，还是测试出来的？](https://zhuanlan.zhihu.com/p/40138584)